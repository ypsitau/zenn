---
title: "pico-jxglib ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚’å®Ÿè£…ã—ã¦ã‚·ã‚§ãƒ«ã‚’å¼·åŒ–ã™ã‚‹è©± (è‡ªå‹•è£œå®Œæ©Ÿèƒ½ã¤ã)"
emoji: "ğŸ‘Œ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["çµ„ã¿è¾¼ã¿", "raspberrypi", "pico", "raspberrypipico", "usb"]
published: false
---
**pico-jxglib** ã¯ã€ãƒ¯ãƒ³ãƒœãƒ¼ãƒ‰ãƒã‚¤ã‚³ãƒ³ Raspberry Pi Pico ã® Pico SDK ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚

https://zenn.dev/ypsitau/articles/2025-01-24-jxglib-intro

ä»Šå›ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚’å®Ÿè£…ã—ã¦ FAT ã¨ LittleFS ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€Pico ãƒœãƒ¼ãƒ‰ä¸Šã®ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã¨ã—ã¦æ‰±ã†ã“ã¨ãŒã§ãã€SD ã‚«ãƒ¼ãƒ‰ã‚„ USB ãƒ¡ãƒ¢ãƒªãªã©ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ‡ãƒã‚¤ã‚¹ã‚’ç°¡å˜ã«æ“ä½œã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ã¾ãŸã€ã‚·ã‚§ãƒ«ã‚‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚’åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«å¼·åŒ–ã—ã€è‡ªå‹•è£œå®Œæ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¾ã™ã€‚

ãªãŠã€ã“ã®å›ã§ã¯ä¿å­˜ãƒ‡ãƒã‚¤ã‚¹ã¨ã—ã¦ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªã‚’æ‰±ã„ã¾ã™ã€‚SD ã‚«ãƒ¼ãƒ‰ã‚„ USB ãƒ¡ãƒ¢ãƒªãªã©ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ‡ãƒã‚¤ã‚¹ã‚’æ‰±ã†ãŸã‚ã®æ–¹æ³•ã¯æ¬¡å›ä»¥é™ã«èª¬æ˜ã—ã¾ã™ã€‚

## ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã«ã¤ã„ã¦

çµ„è¾¼ã¿ç”¨é€”ã§ã¯ã€ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã¨ã—ã¦æ‰±ã†ã“ã¨ãŒã‚ˆãã‚ã‚Šã¾ã™ã€‚ãã®ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦ FatFs ã‚„ LittleFS ãªã©ãŒã‚ã‚Šã€æ¯”è¼ƒçš„å®¹æ˜“ã«è‡ªä½œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚’çµ„ã¿è¾¼ã‚ã‚‹ã®ã§ã™ãŒã€ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ‡ãƒã‚¤ã‚¹ã®ãƒ‰ãƒ©ã‚¤ãƒã‚’æœ€åˆã‹ã‚‰ä½œã‚‹ã®ã¯å°‘ã€…é¢å€’ã§ã™ã€‚ã¾ãŸã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½œæˆã‚„å‰Šé™¤ã‚’è¡Œã†æ‰‹æ®µãŒç”¨æ„ã•ã‚Œã¦ã„ãªã„ãŸã‚ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ å†…ã«ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

**pico-jxglib** ã§ã¯ã€ã“ã‚Œã‚‰ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ãƒ©ãƒƒãƒ—ã—ã¦ã€Pico SDK ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‹ã‚‰ç°¡å˜ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚’æ‰±ãˆã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚ã•ã‚‰ã«ã€ã‚·ã‚§ãƒ«ã‚’å¼·åŒ–ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œç”¨ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè£…ã— ã€ä¸€èˆ¬çš„ãª OS ã®ã‚·ã‚§ãƒ«ã®ã‚ˆã†ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚’æ“ä½œã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚

**pico-jxglib** ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã¯ã€ä»¥ä¸‹ã®ç‰¹å¾´ã‚’æŒã£ã¦ã„ã¾ã™ã€‚

- ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã¨ã—ã¦ FAT ã¨ LittleFS ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™
- ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ‡ãƒã‚¤ã‚¹ã¨ã—ã¦ã€Pico ãƒœãƒ¼ãƒ‰ä¸Šã®ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªãƒ»SD ã‚«ãƒ¼ãƒ‰ãƒ»USB ãƒ¡ãƒ¢ãƒªã‚’æ‰±ã†ã“ã¨ãŒã§ãã¾ã™
- ã‚·ã‚§ãƒ«ä¸Šã§ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚³ãƒ”ãƒ¼ã‚„å‰Šé™¤ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½œæˆã‚„å‰Šé™¤ãªã©ã®åŸºæœ¬çš„ãªãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œãŒå¯èƒ½ã§ã™
- ã‚·ã‚§ãƒ«ã‚³ãƒãƒ³ãƒ‰ã®å‡ºåŠ›ã‚’ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã§ãã¾ã™
- è‡ªå‹•è£œå®Œæ©Ÿèƒ½ã‚’æŒã¡ã€ã‚·ã‚§ãƒ«ã‚³ãƒãƒ³ãƒ‰ã®å…¥åŠ›ã‚’è£œå®Œã§ãã¾ã™

## å®Ÿéš›ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ

ä»Šå›ã¯ Pico ãƒœãƒ¼ãƒ‰ä¸Šã®ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã¨ã—ã¦æ‰±ã†ã®ã§ã€Pico ãƒœãƒ¼ãƒ‰ä»¥å¤–ã«ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã®æº–å‚™ã¯å¿…è¦ã‚ã‚Šã¾ã›ã‚“ã€‚


### é–‹ç™ºç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

Visual Studio Code ã‚„ Git ãƒ„ãƒ¼ãƒ«ã€Pico SDK ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒæ¸ˆã‚“ã§ã„ãªã„æ–¹ã¯[ã€ŒPico SDK ã“ã¨ã¯ã˜ã‚ã€](https://zenn.dev/ypsitau/articles/2025-01-17-picosdk#%E9%96%8B%E7%99%BA%E7%92%B0%E5%A2%83) ã‚’ã”è¦§ãã ã•ã„ã€‚

GitHub ã‹ã‚‰ **pico-jxglib** ã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã¾ã™ã€‚

```bash
git clone https://github.com/ypsitau/pico-jxglib.git
cd pico-jxglib
git submodule update --init
```

:::message
**pico-jxglib** ã¯ã»ã¼æ¯æ—¥æ›´æ–°ã•ã‚Œã¦ã„ã¾ã™ã€‚ã™ã§ã«ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã¦ã„ã‚‹å ´åˆã¯ã€`pico-jxglib` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦æœ€æ–°ã®ã‚‚ã®ã«ã—ã¦ãã ã•ã„ã€‚

```bash
git pull
```

:::

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ

VSCode ã®ã‚³ãƒãƒ³ãƒ‰ãƒ‘ãƒ¬ãƒƒãƒˆã‹ã‚‰ `>Raspberry Pi Pico: New Pico Project` ã‚’å®Ÿè¡Œã—ã€ä»¥ä¸‹ã®å†…å®¹ã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚Pico SDK ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆã®è©³ç´°ã‚„ã€ãƒ“ãƒ«ãƒ‰ã€ãƒœãƒ¼ãƒ‰ã¸ã®æ›¸ãè¾¼ã¿æ–¹æ³•ã«ã¤ã„ã¦ã¯[ã€ŒPico SDK ã“ã¨ã¯ã˜ã‚ã€](https://zenn.dev/ypsitau/articles/2025-01-17-picosdk#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E4%BD%9C%E6%88%90%E3%81%A8%E7%B7%A8%E9%9B%86) ã‚’å‚ç…§ãã ã•ã„ã€‚

- **Name** ... ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã‚’å…¥åŠ›ã—ã¾ã™ã€‚ä»Šå›ã¯ä¾‹ã¨ã—ã¦ `fs-test` ã‚’å…¥åŠ›ã—ã¾ã™
- **Board type** ... ãƒœãƒ¼ãƒ‰ç¨®åˆ¥ã‚’é¸æŠã—ã¾ã™
- **Location** ... ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œã‚‹ä¸€ã¤ä¸Šã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’é¸æŠã—ã¾ã™
- **Stdio support** .. Stdio ã«æ¥ç¶šã™ã‚‹ãƒãƒ¼ãƒˆ (UART ã¾ãŸã¯ USB) ã‚’é¸æŠã—ã¾ã™
- **Code generation options** ... **`Generate C++ code` ã«ãƒã‚§ãƒƒã‚¯ã‚’ã¤ã‘ã¾ã™**

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¨ `pico-jxglib` ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ç½®ãŒä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã¨æƒ³å®šã—ã¾ã™ã€‚

```text
+-[pico-jxglib]
+-[fs-test]
  +-CMakeLists.txt
  +-fs-test.cpp
  +- ...
```


ä»¥ä¸‹ã€ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚‚ã¨ã« `CMakeLists.txt` ã‚„ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã—ã¦ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä½œæˆã—ã¦ã„ãã¾ã™ã€‚

### Pico ãƒœãƒ¼ãƒ‰ã®ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªã«ã¤ã„ã¦

Pico ãƒœãƒ¼ãƒ‰ã®ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªã¯ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¢ãƒ‰ãƒ¬ã‚¹ç¯„å›²ã‚’æŒã£ã¦ã„ã¾ã™ã€‚

- Pico ãƒœãƒ¼ãƒ‰: 0x1000'0000 - 0x101f'ffff (2MB)
- Pico2 ãƒœãƒ¼ãƒ‰: 0x1000'0000 - 0x103f'ffff (4MB)

ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯å…ˆé ­ã® 0x1000'0000 ã‹ã‚‰æ›¸ãè¾¼ã¾ã‚Œã‚‹ã®ã§ã€æ®‹ã‚Šã®ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã¨ã—ã¦åˆ©ç”¨ã§ãã¾ã™ã€‚ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒå æœ‰ã™ã‚‹ç¯„å›²ã‚’ç¢ºèªã™ã‚‹ã«ã¯ä»¥ä¸‹ã®æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚

- **ãƒãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‚ç…§ã™ã‚‹**
  ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸­ã® `build` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä¸­ã« `fs-test.elf.map` ã®ã‚ˆã†ãªåå‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã‚‹ã®ã§ã€ã“ã®ä¸­ã‹ã‚‰ `.flash_end` ã‚’æ¤œç´¢ã—ã¾ã™ã€‚ã“ã®ã‚·ãƒ³ãƒœãƒ«ã®å€¤ãŒãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒå æœ‰ã™ã‚‹ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªã®çµ‚ç«¯ã‚¢ãƒ‰ãƒ¬ã‚¹ã«ãªã‚Šã¾ã™ã€‚

- **picotoolã€€ã‚’ä½¿ã†**
  picotool ã‚’ä½¿ã£ã¦ã€ãƒ“ãƒ«ãƒ‰ã—ãŸ ELF ãƒ•ã‚¡ã‚¤ãƒ«ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚ãƒ›ã‚¹ãƒˆ PC ã®ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‹ã‚‰ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

  ```bash
  picotool info build/fs-test.elf
  ```

  ```text
  File .\build\fs-test.elf:
  
  Program Information
   name:          fs-test
   version:       0.1
   features:      UART stdin / stdout
   binary start:  0x10000000
   binary end:    0x100049d4
  ```

  `binary end` ã®å€¤ãŒãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒå æœ‰ã™ã‚‹ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªã®çµ‚ç«¯ã‚¢ãƒ‰ãƒ¬ã‚¹ã«ãªã‚Šã¾ã™ã€‚

- **pico-jxglib ã®ã‚·ã‚§ãƒ«ã‚’ä½¿ã†**
  Pico ãƒœãƒ¼ãƒ‰ã§ã‚·ã‚§ãƒ«ãŒå‹•ã„ã¦ã„ã‚Œã°ã€ã‚·ã‚§ãƒ«ã‚³ãƒãƒ³ãƒ‰ `about-me` ã‚’ä½¿ã£ã¦å®Ÿè¡Œä¸­ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®æƒ…å ±ã‚’ç¢ºèªã§ãã¾ã™ã€‚Pico ãƒœãƒ¼ãƒ‰ã®ã‚·ã‚§ãƒ«ã«æ¥ç¶šã—ã¦ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

  ```text
  > about-me
  ```

  picotool ã¨åŒã˜ã‚ˆã†ãªæƒ…å ±ã‚’è¡¨ç¤ºã™ã‚‹ã®ã§ã€`binary end` ã®å€¤ã‚’ç¢ºèªã—ã¾ã™ã€‚

ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®çµ‚ç«¯ã‚¢ãƒ‰ãƒ¬ã‚¹ã®ç›®å®‰ã§ã™ãŒã€ãƒ¡ãƒ¢ãƒªã‚’å¤šãæ¶ˆè²»ã—ãã†ãª 16 ãƒ‰ãƒƒãƒˆã®æ—¥æœ¬èªãƒ•ã‚©ãƒ³ãƒˆ (ç¬¬ä¸€ãƒ»ç¬¬äºŒæ°´æº–ã‚’å«ã‚€) ã‚’ãƒªãƒ³ã‚¯ã—ãŸãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ 500kB ç¨‹åº¦ã§ã—ãŸã€‚ä»¥é™ã®ã‚µãƒ³ãƒ—ãƒ«ã§ã¯ã€å‰åŠã® 1MB ã‚’ãƒ—ãƒ­ã‚°ãƒ©ãƒ ç”¨ã«ç¢ºä¿ã—ã€ãã‚Œä»¥é™ã®é ˜åŸŸã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã«ä½¿ã„ã¾ã™ã€‚

### LittleFS ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…

LittleFS ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚’çµ„ã¿è¾¼ã‚€ã«ã¯ `CMakeLists.txt` ã®æœ€å¾Œã«ä»¥ä¸‹ã®è¡Œã‚’è¿½åŠ ã—ã¾ã™ã€‚

```cmake
target_link_libraries(fs-test jxglib_LFS_Flash)
add_subdirectory(${CMAKE_CURRENT_LIST_DIR}/../pico-jxglib pico-jxglib)
```

ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«ç·¨é›†ã—ã¾ã™ã€‚

```cpp:fs-test.cpp
#include <stdio.h>
#include "pico/stdlib.h"
#include "jxglib/LFS/Flash.h"

using namespace jxglib;

int main()
{
    ::stdio_init_all();
    LFS::Flash fat("Flash", 0x0004'0000); // 256kB
    for (;;) {
        // any job
        Tickable::Tick();
    }
}
```

`LFS::Flash` ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã™ã‚‹ã¨ã€Pico ãƒœãƒ¼ãƒ‰ä¸Šã®ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªã‚’ LittleFS ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã¨ã—ã¦æ‰±ãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚æœ€åˆã®å¼•æ•°ã¯ãƒ‰ãƒ©ã‚¤ãƒ–åã§ã€ä»»æ„ã®æ–‡å­—åˆ—ã‚’æŒ‡å®šã§ãã¾ã™ã€‚2 ç•ªç›®ã®å¼•æ•°ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®ã‚µã‚¤ã‚ºã‚’æŒ‡å®šã™ã‚‹ã¨ã€åˆ©ç”¨å¯èƒ½ãªãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªã®æœ€å¾Œã®éƒ¨åˆ†ã‹ã‚‰ãã®ã‚µã‚¤ã‚ºåˆ†ã‚’ LittleFS ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã«ç¢ºä¿ã—ã¾ã™ã€‚

### FAT ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…

FAT ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚’çµ„ã¿è¾¼ã‚€ã«ã¯ `CMakeLists.txt` ã®æœ€å¾Œã«ä»¥ä¸‹ã®è¡Œã‚’è¿½åŠ ã—ã¾ã™ã€‚

```cmake
target_link_libraries(fs-test jxglib_FAT_Flash)
add_subdirectory(${CMAKE_CURRENT_LIST_DIR}/../pico-jxglib pico-jxglib)
jxglib_configure_FAT(fs-test FF_VOLUMES 1)
```

FatFs ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚³ãƒ³ãƒ•ã‚£ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã€€`ffconf.h` ã‚’ç”Ÿæˆã™ã‚‹ãŸã‚ã€`jxglib_configure_FAT()` ã‚’å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«ç·¨é›†ã—ã¾ã™ã€‚

```cpp:fs-test.cpp
#include <stdio.h>
#include "pico/stdlib.h"
#include "jxglib/FAT/Flash.h"

using namespace jxglib;

int main()
{
    ::stdio_init_all();
    FAT::Flash fat("Flash", 0x0004'0000); // 256kB
    for (;;) {
        // any job
        Tickable::Tick();
    }
}
```

`FAT::Flash` ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã™ã‚‹ã¨ã€Pico ãƒœãƒ¼ãƒ‰ä¸Šã®ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªã‚’ FAT ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã¨ã—ã¦æ‰±ãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚æœ€åˆã®å¼•æ•°ã¯ãƒ‰ãƒ©ã‚¤ãƒ–åã§ã€ä»»æ„ã®æ–‡å­—åˆ—ã‚’æŒ‡å®šã§ãã¾ã™ã€‚2 ç•ªç›®ã®å¼•æ•°ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®ã‚µã‚¤ã‚ºã‚’æŒ‡å®šã™ã‚‹ã¨ã€åˆ©ç”¨å¯èƒ½ãªãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªã®æœ€å¾Œã®éƒ¨åˆ†ã‹ã‚‰ãã®ã‚µã‚¤ã‚ºåˆ†ã‚’ FAT ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã«ç¢ºä¿ã—ã¾ã™ã€‚

### è¤‡æ•°ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…

è¤‡æ•°ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚’åŒæ™‚ã«å®Ÿè£…ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚ä¾‹ãˆã°ã€FAT ã¨ LittleFS ã®ä¸¡æ–¹ã‚’å®Ÿè£…ã™ã‚‹ã«ã¯ã€`CMakeLists.txt` ã®æœ€å¾Œã«ä»¥ä¸‹ã®è¡Œã‚’è¿½åŠ ã—ã¾ã™ã€‚

```cmake
target_link_libraries(fs-test jxglib_LFS_Flash jxglib_FAT_Flash)
add_subdirectory(${CMAKE_CURRENT_LIST_DIR}/../pico-jxglib pico-jxglib)
jxglib_configure_FAT(fs-test FF_VOLUMES 2)
```

ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«ç·¨é›†ã—ã¾ã™ã€‚

```cpp:fs-test.cpp
#include <stdio.h>
#include "pico/stdlib.h"
#include "jxglib/ShellCmd_FS.h"
#include "jxglib/Shell.h"
#include "jxglib/Serial.h"

using namespace jxglib;

int main()
{
    ::stdio_init_all();
    LFS::Flash lfs("A", 0x1010'0000, 0x0004'0000);  // 256kB
    LFS::Flash lfs("B", 0x1014'0000, 0x0004'0000);  // 256kB
    FAT::Flash fat("*C", 0x1018'0000, 0x0004'0000); // 256kB (primary)
    FAT::Flash fat("D", 0x101c'0000, 0x0004'0000);  // 256kB
    for (;;) {
        // any job
        Tickable::Tick();
    }
}
```

### ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚’ã‚·ã‚§ãƒ«ã§æ“ä½œã™ã‚‹

```cmake
target_link_libraries(fs-test jxglib_LFS_Flash jxglib_FAT_Flash jxglib_ShellCmd_FS Serial)
add_subdirectory(${CMAKE_CURRENT_LIST_DIR}/../pico-jxglib pico-jxglib)
jxglib_configure_FAT(fs-test FF_VOLUMES 2)
```

ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«ç·¨é›†ã—ã¾ã™ã€‚

```cpp:fs-test.cpp
#include <stdio.h>
#include "pico/stdlib.h"
#include "jxglib/LFS/Flash.h"
#include "jxglib/FAT/Flash.h"
#include "jxglib/ShellCmd_FS.h"
#include "jxglib/Shell.h"
#include "jxglib/Serial.h"

using namespace jxglib;

int main()
{
    ::stdio_init_all();
    LFS::Flash lfs("A", 0x1010'0000, 0x0004'0000);  // 256kB
    LFS::Flash lfs("B", 0x1014'0000, 0x0004'0000);  // 256kB
    FAT::Flash fat("*C", 0x1018'0000, 0x0004'0000); // 256kB (primary)
    FAT::Flash fat("D", 0x101c'0000, 0x0004'0000);  // 256kB
    Serial::Terminal terminal;
    Shell::AttachTerminal(terminal.Initialize());
    for (;;) {
        // any job
        Tickable::Tick();
    }
}
```
