---
title: "æ“ä½œæ–¹æ³•ã‚’çŸ¥ã£ã¦ä½¿ã„ã“ãªã™! pwm ã‚³ãƒãƒ³ãƒ‰ã§ Pico ã® PWM ã®é™ç•Œã‚’æ¢ã‚‹"
emoji: "ğŸ£"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["çµ„ã¿è¾¼ã¿", "raspberrypi", "pico", "raspberrypipico", "pwm"]
published: true
---
[pico-jxgLABO](https://zenn.dev/ypsitau/articles/2025-08-01-labo-intro) ã¯ã€USB ã‚±ãƒ¼ãƒ–ãƒ«ä¸€æœ¬ã§ãƒ¯ãƒ³ãƒœãƒ¼ãƒ‰ãƒã‚¤ã‚³ãƒ³ RaspberryPi Pico ã®æ§˜ã€…ãªæ©Ÿèƒ½ã‚’è©¦ã™ã“ã¨ãŒã§ãã‚‹å®Ÿé¨“ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚

ä»Šå›ã®è¨˜äº‹ã§ã¯ã€pico-jxgLABO ã® `pwm` ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã£ã¦ Pico ã® PWM æ©Ÿèƒ½ã®å®Ÿé¨“ã‚’ã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

PWM (Pulse Width Modulation) ã¯ã€ãƒ¢ãƒ¼ã‚¿ãƒ¼ã®é€Ÿåº¦åˆ¶å¾¡ã‚„ LED ã®æ˜ã‚‹ã•èª¿æ•´ãªã©ã€æ§˜ã€…ãªç”¨é€”ã§ä½¿ã‚ã‚Œã‚‹æŠ€è¡“ã§ã™ã€‚Pico ãƒœãƒ¼ãƒ‰ã¯ã€GPIO ãƒ”ãƒ³ã‚’ä½¿ã£ã¦ PWM ä¿¡å·ã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ãŒã€ãã®è¨­å®šã¯ã¡ã‚‡ã£ã¨ã‚ã‹ã‚Šã¥ã‚‰ã„ã¨ã“ã‚ãŒã‚ã‚Šã¾ã™ã€‚ã¾ã‚å‹•ã‘ã°ã„ã„ã‹ãªã€ã¨ãŸã ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ãã¦å‹•ã‹ã—ã¦ã„ã‚‹äººã‚‚å¤šã„ã®ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã€‚

pico-jxgLABO ã‚’ä½¿ãˆã°ã€å®Ÿéš›ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ“ä½œã—ã¦ãƒ­ã‚¸ãƒƒã‚¯ã‚¢ãƒŠãƒ©ã‚¤ã‚¶ã§æ³¢å½¢ã‚’è¦³æ¸¬ã—ãªãŒã‚‰ã€PWM ã®è¨­å®šã‚„å‹•ä½œã‚’ç†è§£ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

## pico-jxgLABO ã®å°å…¥æ–¹æ³•

pico-jxgLABO ã®å°å…¥æ–¹æ³•ã¯[ã“ã¡ã‚‰](https://zenn.dev/ypsitau/articles/2025-08-01-labo-intro)ã€‚ç‰¹åˆ¥ãªã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚„ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã¯å¿…è¦ãªãã€RaspberryPi Pico ã¾ãŸã¯ Pico 2 ã‚’ USB ã‚±ãƒ¼ãƒ–ãƒ«ã§ PC ã«æ¥ç¶šã™ã‚‹ã ã‘ã§å§‹ã‚ã‚‰ã‚Œã¾ã™ã€‚

## `pwm` ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã£ãŸ PWM ã®åˆ¶å¾¡

`pwm` ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã£ã¦ PWM ã®å®Ÿé¨“ã‚’ã—ã¦ã„ãã¾ã™ã€‚ã“ã“ã§ã¯ Pico 2 ã‚’ä½¿ã„ã¾ã™ãŒã€Pico ã§ã‚‚åŒæ§˜ã«å®Ÿé¨“ã§ãã¾ã™ã€‚

### ç¾åœ¨ã® PWM çŠ¶æ…‹ã®è¡¨ç¤º

å¼•æ•°ãªã—ã§ `pwm` ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ã™ã¹ã¦ã® GPIO ã® PWM è¨­å®šçŠ¶æ…‹ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

```text
L:/>pwm
GPIO0  func:------
GPIO1  func:------
GPIO2  func:------
GPIO3  func:------
GPIO4  func:------
GPIO5  func:------
GPIO6  func:------
GPIO7  func:------
GPIO8  func:------
GPIO9  func:------
GPIO10 func:------
GPIO11 func:------
GPIO12 func:------
GPIO13 func:------
GPIO14 func:------
GPIO15 func:------
GPIO16 func:------
GPIO17 func:------
GPIO18 func:------
GPIO19 func:------
GPIO20 func:------
GPIO21 func:------
GPIO22 func:------
GPIO23*func:------
GPIO24*func:------
GPIO25*func:------
GPIO26 func:------
GPIO27 func:------
GPIO28 func:------
GPIO29*func:------
```

ã¾ã  PWM ã®è¨­å®šã¯è¡Œã‚ã‚Œã¦ã„ãªã„ã®ã§ã€ã™ã¹ã¦ã® GPIO ã® `func` ãŒ `------` ã¨ãªã£ã¦ã„ã¾ã™ã€‚GPIO ãƒ”ãƒ³ç•ªå·ã‚’æŒ‡å®šã—ã¦ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰ `func:pwm` ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ãƒ•ã‚¡ãƒ³ã‚¯ã‚·ãƒ§ãƒ³ã‚’ PWM ã«è¨­å®šã§ãã¾ã™ã€‚ä»¥ä¸‹ã®ä¾‹ã§ã¯ã€ã™ã¹ã¦ã® GPIO ãƒ”ãƒ³ã‚’ PWM ã«è¨­å®šã—ã¦ã„ã¾ã™ã€‚

```text
L:/>pwm 0- func:pwm
GPIO0  func:PWM0 A     disabled freq:2288Hz (clkdiv:1.0 wrap:0xffff) duty:0.000 (level:0x0000) counter:0x0000
GPIO1  func:PWM0 B     disabled freq:2288Hz (clkdiv:1.0 wrap:0xffff) duty:0.000 (level:0x0000) counter:0x0000
GPIO2  func:PWM1 A     disabled freq:2288Hz (clkdiv:1.0 wrap:0xffff) duty:0.000 (level:0x0000) counter:0x0000
GPIO3  func:PWM1 B     disabled freq:2288Hz (clkdiv:1.0 wrap:0xffff) duty:0.000 (level:0x0000) counter:0x0000
GPIO4  func:PWM2 A     disabled freq:2288Hz (clkdiv:1.0 wrap:0xffff) duty:0.000 (level:0x0000) counter:0x0000
GPIO5  func:PWM2 B     disabled freq:2288Hz (clkdiv:1.0 wrap:0xffff) duty:0.000 (level:0x0000) counter:0x0000
GPIO6  func:PWM3 A     disabled freq:2288Hz (clkdiv:1.0 wrap:0xffff) duty:0.000 (level:0x0000) counter:0x0000
GPIO7  func:PWM3 B     disabled freq:2288Hz (clkdiv:1.0 wrap:0xffff) duty:0.000 (level:0x0000) counter:0x0000
GPIO8  func:PWM4 A     disabled freq:2288Hz (clkdiv:1.0 wrap:0xffff) duty:0.000 (level:0x0000) counter:0x0000
GPIO9  func:PWM4 B     disabled freq:2288Hz (clkdiv:1.0 wrap:0xffff) duty:0.000 (level:0x0000) counter:0x0000
GPIO10 func:PWM5 A     disabled freq:2288Hz (clkdiv:1.0 wrap:0xffff) duty:0.000 (level:0x0000) counter:0x0000
GPIO11 func:PWM5 B     disabled freq:2288Hz (clkdiv:1.0 wrap:0xffff) duty:0.000 (level:0x0000) counter:0x0000
GPIO12 func:PWM6 A     disabled freq:2288Hz (clkdiv:1.0 wrap:0xffff) duty:0.000 (level:0x0000) counter:0x0000
GPIO13 func:PWM6 B     disabled freq:2288Hz (clkdiv:1.0 wrap:0xffff) duty:0.000 (level:0x0000) counter:0x0000
GPIO14 func:PWM7 A     disabled freq:2288Hz (clkdiv:1.0 wrap:0xffff) duty:0.000 (level:0x0000) counter:0x0000
GPIO15 func:PWM7 B     disabled freq:2288Hz (clkdiv:1.0 wrap:0xffff) duty:0.000 (level:0x0000) counter:0x0000
GPIO16 func:PWM0 A     disabled freq:2288Hz (clkdiv:1.0 wrap:0xffff) duty:0.000 (level:0x0000) counter:0x0000
GPIO17 func:PWM0 B     disabled freq:2288Hz (clkdiv:1.0 wrap:0xffff) duty:0.000 (level:0x0000) counter:0x0000
GPIO18 func:PWM1 A     disabled freq:2288Hz (clkdiv:1.0 wrap:0xffff) duty:0.000 (level:0x0000) counter:0x0000
GPIO19 func:PWM1 B     disabled freq:2288Hz (clkdiv:1.0 wrap:0xffff) duty:0.000 (level:0x0000) counter:0x0000
GPIO20 func:PWM2 A     disabled freq:2288Hz (clkdiv:1.0 wrap:0xffff) duty:0.000 (level:0x0000) counter:0x0000
GPIO21 func:PWM2 B     disabled freq:2288Hz (clkdiv:1.0 wrap:0xffff) duty:0.000 (level:0x0000) counter:0x0000
GPIO22 func:PWM3 A     disabled freq:2288Hz (clkdiv:1.0 wrap:0xffff) duty:0.000 (level:0x0000) counter:0x0000
GPIO23*func:------
GPIO24*func:------
GPIO25*func:------
GPIO26 func:PWM5 A     disabled freq:2288Hz (clkdiv:1.0 wrap:0xffff) duty:0.000 (level:0x0000) counter:0x0000
GPIO27 func:PWM5 B     disabled freq:2288Hz (clkdiv:1.0 wrap:0xffff) duty:0.000 (level:0x0000) counter:0x0000
GPIO28 func:PWM6 A     disabled freq:2288Hz (clkdiv:1.0 wrap:0xffff) duty:0.000 (level:0x0000) counter:0x0000
GPIO29*func:------
```

GPIO23, GPIO24, GPIO25, GPIO29 ã¯ç‰¹æ®Šç”¨é€”ã«ä½¿ã‚ã‚Œã‚‹ãŸã‚ã€`pwm` ã§ã¯æ“ä½œãŒã§ããªã„ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚ãŸã ã—ã€Pico ã‚„ Pico 2 ã® GPIO25 ã¯å†…è”µ LED ã«æ¥ç¶šã•ã‚Œã¦ãŠã‚Šã€æ‰‹è»½ã«ä½¿ãˆã¦ä¾¿åˆ©ãªã®ã§ã‚ªãƒ—ã‚·ãƒ§ãƒ³ `-B` (ã¾ãŸã¯ `--builtin-led`) ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§æ“ä½œã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚

Pico ã® GPIO ã¯ã™ã¹ã¦ PWM ã«å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚Pico ã® PWM ã®æ©Ÿèƒ½å˜ä½ã¯ã‚¹ãƒ©ã‚¤ã‚¹ã¨å‘¼ã°ã‚Œã€PWM0 ã‹ã‚‰ PWM7 ã¾ã§ã® 8 å€‹ã®ã‚¹ãƒ©ã‚¤ã‚¹ãŒã‚ã‚Šã¾ã™ã€‚å„ã‚¹ãƒ©ã‚¤ã‚¹ã¯ A ã¨ B ã® 2 ã¤ã®ãƒãƒ£ãƒãƒ«ã‚’æŒã¡ã€åˆè¨ˆã§ 16 å€‹ã®ãƒãƒ£ãƒãƒ«ãŒå­˜åœ¨ã—ã¾ã™ã€‚


ã‚¹ãƒ©ã‚¤ã‚¹ã”ã¨ã« PWM ã®æœ‰åŠ¹/ç„¡åŠ¹çŠ¶æ…‹ã€å‘¨æ³¢æ•°ã‚„ã‚«ã‚¦ãƒ³ã‚¿ã®è¨­å®šãŒã§ãã¾ã™ãŒã€A ã¨ B ã®ãƒãƒ£ãƒãƒ«ã¯åŒã˜ã‚¹ãƒ©ã‚¤ã‚¹ã®è¨­å®šã‚’å…±æœ‰ã—ã¾ã™ã€‚ã¤ã¾ã‚Šã€A ã¨ B ã®ãƒãƒ£ãƒãƒ«ã¯åŒã˜å‘¨æ³¢æ•°ã§å‹•ä½œã—ã€ã‚«ã‚¦ãƒ³ã‚¿ã‚‚åŒæœŸã—ã¦å‹•ãã¾ã™ã€‚åŒã˜ã‚¹ãƒ©ã‚¤ã‚¹å†…ã§ã¯ã€ãƒ‡ãƒ¥ãƒ¼ãƒ†ã‚£æ¯”ã ã‘ãŒãƒãƒ£ãƒãƒ« A ã¨ B ã§å€‹åˆ¥ã«è¨­å®šã§ãã¾ã™ã€‚

ãã‚Œã§ã¯ã€PWM ã®å®Ÿé¨“ã‚’ã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã€ãƒ•ã‚¡ãƒ³ã‚¯ã‚·ãƒ§ãƒ³ã‚’åˆæœŸçŠ¶æ…‹ã«æˆ»ã—ã¦ãŠã„ã¦ãã ã•ã„ã€‚

```text
L:/>pwm 0- func:-
```

### GPIO ãƒ”ãƒ³ç•ªå·ã®æŒ‡å®šæ–¹æ³•

`pwm` ã‚³ãƒãƒ³ãƒ‰ã®æœ€åˆã®å¼•æ•°ã«ã¯ã€GPIO ãƒ”ãƒ³ç•ªå·ã‚’æŒ‡å®šã—ã¾ã™ã€‚å˜ä¸€ã® GPIO ãƒ”ãƒ³ç•ªå·ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã—ã€ç¯„å›²ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚ä¾‹ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ã€‚

|ã‚³ãƒãƒ³ãƒ‰ã€€      |èª¬æ˜                                 |
|---------------|-------------------------------------|
|`pwm 0`       |GPIO0 ã® PWM ã®çŠ¶æ…‹ã‚’è¡¨ç¤ºã—ã¾ã™               |
|`pwm 2,3,8,9` |GPIO2,3,8,9 ã® PWM ã®çŠ¶æ…‹ã‚’è¡¨ç¤ºã—ã¾ã™         |
|`pwm 2-15`    |GPIO2 ã‹ã‚‰ GPIO15 ã¾ã§ã® PWM ã®çŠ¶æ…‹ã‚’è¡¨ç¤ºã—ã¾ã™|
|`pwm 8-`      |GPIO8 ã‹ã‚‰ GPIO29 ã¾ã§ã® PWM ã®çŠ¶æ…‹ã‚’è¡¨ç¤ºã—ã¾ã™|

å˜ä¸€ã®ãƒ”ãƒ³æ“ä½œã®ãŸã‚ã®ã‚³ãƒãƒ³ãƒ‰ `pwm0` ã‹ã‚‰ `pwm29` ã‚‚ç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚ä¾‹ãˆã° `pwm2` ã¯ `pwm 2` ã¨åŒã˜æ„å‘³ã«ãªã‚Šã¾ã™ã€‚

### LED ã®æ˜ã‚‹ã•ã‚’ PWM ã§èª¿æ•´ã™ã‚‹

ã¾ãšã¯ã€LED ã®æ˜ã‚‹ã•ã‚’ PWM ã§èª¿æ•´ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚Pico ã‚„ Pico 2 ã® GPIO25 ã«æ¥ç¶šã•ã‚ŒãŸ LED ã‚’åˆ¶å¾¡ã—ã¾ã™ã€‚Pico W, Pico 2 W ã®å ´åˆã¯é©å½“ãª GPIO ãƒ”ãƒ³ã« LED ã‚’æ¥ç¶šã—ã¦ãã ã•ã„ã€‚

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã€GPIO25 ã® PWM ã‚’æœ‰åŠ¹ã«ã—ã€å‘¨æ³¢æ•°ã‚’ 100Hzã€ãƒ‡ãƒ¥ãƒ¼ãƒ†ã‚£æ¯”ã‚’ 0.5 (50%) ã«è¨­å®šã—ã¾ã™ã€‚ã‚ªãƒ—ã‚·ãƒ§ãƒ³ `-B` ã¯ã€GPIO25 ã®æ“ä½œã‚’è¨±å¯ã™ã‚‹ãŸã‚ã®ã‚‚ã®ã§ã™ã€‚

```text
L:/>pwm25 -B func:pwm freq:100 duty:0.5 enable
GPIO25 func:PWM4 B     enabled  freq:100Hz (clkdiv:23.0 wrap:0xfec0) duty:0.500 (level:0x7f60) counter:0x0bd5
```

ãƒ‡ãƒ¥ãƒ¼ãƒ†ã‚£æ¯”ã« 0 ã‹ã‚‰ 1 ã®é–“ã®å€¤ã‚’è¨­å®šã™ã‚‹ã¨ LED ã®æ˜ã‚‹ã•ãŒå¤‰åŒ–ã—ã¾ã™ã€‚

```text
L:/>pwm25 -B duty:0
L:/>pwm25 -B duty:0.2
L:/>pwm25 -B duty:0.4
L:/>pwm25 -B duty:0.6
L:/>pwm25 -B duty:0.8
L:/>pwm25 -B duty:1
```

### PWM æ³¢å½¢ã®è¦³æ¸¬

ãƒ‡ãƒ¥ãƒ¼ãƒ†ã‚£æ¯”ã¯ã€PWM ä¿¡å·ã® high ã¨ low ã®æ¯”ç‡ã‚’è¡¨ã—ã¾ã™ã€‚ãƒ­ã‚¸ãƒƒã‚¯ã‚¢ãƒŠãƒ©ã‚¤ã‚¶ã‚’ä½¿ã£ã¦æ³¢å½¢ã‚’è¦³æ¸¬ã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒ¥ãƒ¼ãƒ†ã‚£æ¯”ãŒã©ã®ã‚ˆã†ã« PWM ä¿¡å·ã«åæ˜ ã•ã‚Œã‚‹ã‹ã‚’ç¢ºèªã§ãã¾ã™ã€‚

ä»¥ä¸‹ã®æ‰‹é †ã§ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

1. ãƒ­ã‚¸ãƒƒã‚¯ã‚¢ãƒŠãƒ©ã‚¤ã‚¶ã‚’èµ·å‹•ã—ã¦ã€€GPIO2, GPIO3, GPIO4, GPIO5 ã® 4 æœ¬ã®ãƒ”ãƒ³ã®æ¸¬å®šã‚’é–‹å§‹ã—ã¾ã™ã€‚

   ```text
   L:/>la -p 2-5 enable
   ```

2. å‘¨æ³¢æ•°ãŒ 100Hzã€ãƒ‡ãƒ¥ãƒ¼ãƒ†ã‚£æ¯”ãŒãã‚Œãã‚Œ 0.2, 0.4, 0.6, 0.8 ã® PWM ä¿¡å·ã‚’å‡ºåŠ›ã—ã¾ã™ã€‚

   ```text
   L:/>pwm 2-5 func:pwm disable freq:100 counter:0
   L:/>pwm2 duty:.2; pwm3 duty:.4; pwm4 duty:.6; pwm5 duty:.8
   L:/>pwm 2-5 enable
   ```

3. æ¸¬å®šã—ãŸæ³¢å½¢ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

   ```text
   L:/>la print
   ```

æ¸¬å®šçµæœã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ã€‚ã‚·ãƒªã‚¢ãƒ«ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®ç”»é¢ã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£ã—ã¦æ¨ªå‘ãã«å›è»¢ã—ã¦ã„ã¾ã™ã€‚

![pwm-test-1.png](/images/2025-08-06-labo-pwm/pwm-test-1.png)

ä¸‹ã‹ã‚‰ã€ãƒ‡ãƒ¥ãƒ¼ãƒ†ã‚£æ¯” 0.2, 0.4, 0.6, 0.8 ã® PWM ä¿¡å·ãŒè¦³æ¸¬ã§ãã¦ã„ã¾ã™ã€‚ãƒ‡ãƒ¥ãƒ¼ãƒ†ã‚£æ¯”ãŒå¤§ãããªã‚‹ã»ã©ã€high ã®æ™‚é–“ãŒé•·ããªã‚Šã€æ³¢å½¢ã®å¹…ãŒåºƒãŒã£ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ä¸€ã¤ã®å‘¨æœŸã¯æ³¢å½¢ã®ç¹°ã‚Šè¿”ã—ãƒ‘ã‚¿ãƒ¼ãƒ³ã®é–“éš”ã€ä¾‹ãˆã° 0.00usec ã‹ã‚‰ 9999.92usec ã®é–“ã§ã™ã‹ã‚‰ã€PWM å‘¨æœŸ $T_{\text{PWM}}$ ã¯ã¡ã‚‡ã£ã¨æ•°å€¤ã‚’ä¸¸ã‚ã¦ 10000usecã§ã™ã€‚PWM å‘¨æ³¢æ•° $f_{\text{PWM}}$ ã¯ PWM å‘¨æœŸ $T_{\text{PWM}}$ ã®é€†æ•°ãªã®ã§ã€$f_{\text{PWM}} = \frac{1}{T_{\text{PWM}}} = \frac{1}{10000 \times 10^{-6}}$ = 100Hz ã¨ãªã‚Šã¾ã™ã€‚

### PWM å‘¨æ³¢æ•°ã®è¨­å®šæ–¹æ³•

`pwm` ã‚³ãƒãƒ³ãƒ‰ã§ã¯ PWM ã®å‘¨æ³¢æ•°ã‚’å¤‰æ›´ã™ã‚‹ãŸã‚ã« `freq` ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰ãŒä½¿ãˆã¾ã™ãŒã€ã“ã®å†…éƒ¨ã§ã¯ PWM ã®ã‚¯ãƒ­ãƒƒã‚¯åˆ†å‘¨æ¯” (`clkdiv` å€¤) ã¨ã‚«ã‚¦ãƒ³ã‚¿ã®ãƒ©ãƒƒãƒ—ã‚¢ãƒƒãƒ—å€¤ (`wrap` å€¤) ã®è¨­å®šãŒè¡Œã‚ã‚Œã¦ã„ã¾ã™ã€‚ã“ã‚Œã‚‰ã®è¨­å®šå€¤ã«ã¤ã„ã¦ä»¥ä¸‹èª¬æ˜ã—ã¾ã™ã€‚

PWM ã¯å†…éƒ¨ã« 16bit ã®ã‚«ã‚¦ãƒ³ã‚¿ã‚’æŒã£ã¦ãŠã‚Šã€0 (0x0000) ã‹ã‚‰ 65535 (0xFFFF) ã¾ã§ã®å€¤ã‚’ã¨ã‚Šã¾ã™ã€‚ã‚«ã‚¦ãƒ³ã‚¿ã¯ CPU ã®ã‚¯ãƒ­ãƒƒã‚¯ä¿¡å·ã‚’ `clkdiv` å€¤ã§åˆ†å‘¨ã—ãŸå‘¨æœŸã§ä¸€ã¤ãšã¤å¢—åŠ ã—ã€è¨­å®šã•ã‚ŒãŸ `wrap` å€¤ã«é”ã™ã‚‹ã¨ 0 ã«æˆ»ã‚Šã¾ã™ã€‚ `wrap` å€¤ã¯ã‚«ã‚¦ãƒ³ã‚¿ãŒã¨ã‚Šã†ã‚‹æœ€å¤§å€¤ã«ãªã‚‹ã®ã§ã€Pico ã®ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã§ã¯ `TOP` ã¨ã‚‚å‘¼ç§°ã•ã‚Œã¦ã„ã¾ã™ã€‚

`clkdiv` å€¤ã¨ `wrap` å€¤ãŒã©ã®ã‚ˆã†ã« PWM ã®å‘¨æ³¢æ•°ã«å½±éŸ¿ã™ã‚‹ã‹ã‚’ç†è§£ã™ã‚‹ãŸã‚ã€ä»¥ä¸‹ã®å®Ÿé¨“ã‚’è¡Œã„ã¾ã™ã€‚

- - -

`clkdiv` å€¤ã¯ CPU ã‚¯ãƒ­ãƒƒã‚¯ã®åˆ†å‘¨æ¯”ã‚’ 1.0 ã‹ã‚‰ 255.9 [^clkdiv] ã¾ã§ã®ç¯„å›²ã§è¨­å®šã—ã¾ã™ã€‚ä¾‹ãˆã°ã€`clkdiv` ã‚’ 1.0 ã«ã™ã‚‹ã¨ PWM ã‚¹ãƒ©ã‚¤ã‚¹ã¯ CPU ã‚¯ãƒ­ãƒƒã‚¯ã¨åŒã˜å‘¨æ³¢æ•° (1/1.0) ã§å‹•ä½œã—ã€2.0 ã«ã™ã‚‹ã¨ CPU ã‚¯ãƒ­ãƒƒã‚¯ã®åŠåˆ† (1/2.0) ã®å‘¨æ³¢æ•°ã§å‹•ä½œã—ã¾ã™ã€‚ä»¥ä¸‹ã€ `wrap` å€¤ã‚’æœ€å°ã® 1 ã«è¨­å®šã—ã¦ã€`clkdiv` å€¤ã‚’å¤‰ãˆã¦ã¿ã¾ã™ã€‚

[^clkdiv]: æ­£ç¢ºã«ã¯ 255 + 1/2 + 1/4 + 1/8 + 1/16 = 255.9375

```text
L:/>pwm0 func:pwm clkdiv:1.0 wrap:1
GPIO0  func:PWM0 A     disabled freq:75000000Hz (clkdiv:1.0 wrap:0x0001) duty:0.000 (level:0x0000) counter:0x0000
L:/>pwm0 func:pwm clkdiv:2.0 wrap:1
GPIO0  func:PWM0 A     disabled freq:37500000Hz (clkdiv:2.0 wrap:0x0001) duty:0.000 (level:0x0000) counter:0x0000
L:/>pwm0 func:pwm clkdiv:3.0 wrap:1
GPIO0  func:PWM0 A     disabled freq:25000000Hz (clkdiv:3.0 wrap:0x0001) duty:0.000 (level:0x0000) counter:0x0000
```

Pico 2 ã¯ CPU ã‚¯ãƒ­ãƒƒã‚¯ãŒ 150MHz ã§ã€åˆ†å‘¨æ¯”ãŒ 1.0 ã®å ´åˆã¯ãã®ã‚¯ãƒ­ãƒƒã‚¯ãŒç›´æ¥ PWM ã®å‘¨æ³¢æ•°ã«ãªã‚Šã¾ã™ã€‚ `wrap` å€¤ã‚’ 1 ã«è¨­å®šã—ã¾ã—ãŸã‹ã‚‰ã€ã‚«ã‚¦ãƒ³ã‚¿å€¤ã¯ 0 ã‹ã‚‰å§‹ã¾ã£ã¦ 1 ã«ãªã‚‹ã¨ 0 ã«æˆ»ã‚‹ã€ã¤ã¾ã‚Š 2 å›ã®ã‚«ã‚¦ãƒ³ãƒˆã§ 1 å‘¨æœŸã¨ãªã‚Šã¾ã™ã€‚PWM ã«ä¸ãˆã‚‰ã‚ŒãŸã‚¯ãƒ­ãƒƒã‚¯ã® 1/2ã€ã¤ã¾ã‚Š 75MHz ã®ä¿¡å·ã‚’å‡ºåŠ›ã—ã¾ã™ã€‚

ä»¥ä¸‹ã€`clkdiv` å€¤ã‚’ 2.0ã€3.0 ã¨å¤‰ãˆã¦ã„ãã¨ã€å‘¨æ³¢æ•°ãŒ 1/2, 1/3, ... ã¨å¤‰åŒ–ã—ã¦ã„ãã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚`clkdiv` å€¤ã«å¯¾ã—ã¦ PWM ä¿¡å·ã®å‘¨æ³¢æ•°ã¯ $\frac{1}{\text{clkdiv}}$ ã®é–¢ä¿‚ã«ãªã‚Šã¾ã™ã€‚

- - -

`wrap` å€¤ã¯ã‚«ã‚¦ãƒ³ã‚¿ã®æœ€é«˜å€¤ã‚’ 1 ã‹ã‚‰ 65535 ã¾ã§ã®ç¯„å›²ã§è¨­å®šã—ã¾ã™ã€‚ä»¥ä¸‹ã€`clkdiv` å€¤ã‚’ 1.0 ã«å›ºå®šã—ã¦ `wrap` å€¤ã‚’å¤‰ãˆã¦ã„ãã¾ã™ã€‚

```text
L:/>pwm0 func:pwm clkdiv:1.0 wrap:1
GPIO0  func:PWM0 A     disabled freq:75000000Hz (clkdiv:1.0 wrap:0x0001) duty:0.000 (level:0x0000) counter:0x0000
L:/>pwm0 func:pwm clkdiv:1.0 wrap:2
GPIO0  func:PWM0 A     disabled freq:50000000Hz (clkdiv:1.0 wrap:0x0002) duty:0.000 (level:0x0000) counter:0x0000
L:/>pwm0 func:pwm clkdiv:1.0 wrap:3
GPIO0  func:PWM0 A     disabled freq:37500000Hz (clkdiv:1.0 wrap:0x0003) duty:0.000 (level:0x0000) counter:0x0000
```

åˆ†å‘¨æ¯”ãŒ 1 ã§ã™ã‹ã‚‰ã€PWM ã‚¹ãƒ©ã‚¤ã‚¹ã«ã¯ 150MHz ã®ã‚¯ãƒ­ãƒƒã‚¯ãŒä¾›çµ¦ã•ã‚Œã¦ã„ã¾ã™ã€‚ `wrap` å€¤ã‚’ 1 ã«è¨­å®šã™ã‚‹ã¨ã€ã‚«ã‚¦ãƒ³ã‚¿ã¯ 0 ã‹ã‚‰ 1 ã¾ã§ã® 2 å›ã®ã‚«ã‚¦ãƒ³ãƒˆã§ 1 å‘¨æœŸã¨ãªã‚Šã€å‘¨æ³¢æ•°ã¯ 75MHz ã«ãªã‚Šã¾ã™ã€‚

 `wrap` å€¤ã‚’ 2 ã«è¨­å®šã™ã‚‹ã¨ã€ã‚«ã‚¦ãƒ³ã‚¿ã¯ 0, 1, 2 ã®å¾Œã« 0 ã«æˆ»ã‚Šã€1 å‘¨æœŸãŒ 3 å›ã®ã‚«ã‚¦ãƒ³ãƒˆã§æ§‹æˆã•ã‚Œã‚‹ãŸã‚ã€å‘¨æ³¢æ•°ã¯ 1/3 ã® 50MHz ã«ãªã‚Šã¾ã™ã€‚

 `wrap` å€¤ã‚’ 3 ã«è¨­å®šã™ã‚‹ã¨ã€ã‚«ã‚¦ãƒ³ã‚¿ã¯ 0, 1, 2, 3 ã®å¾Œã« 0 ã«æˆ»ã‚Šã€1 å‘¨æœŸãŒ 4 å›ã®ã‚«ã‚¦ãƒ³ãƒˆã§æ§‹æˆã•ã‚Œã‚‹ãŸã‚ã€å‘¨æ³¢æ•°ã¯ 1/4 ã® 37.5MHz ã«ãªã‚Šã¾ã™ã€‚

ã¤ã¾ã‚Šã€ `wrap` å€¤ã«å¯¾ã—ã¦ PWM ä¿¡å·ã®å‘¨æ³¢æ•°ã¯ $\frac{1}{\text{wrap} + 1}$ ã®é–¢ä¿‚ã«ãªã‚Šã¾ã™ã€‚

- - -

ä»¥ä¸Šã€`clkdiv` å€¤ã¨ `wrap` å€¤ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã¨ã€PWM ä¿¡å·ã®å‘¨æ³¢æ•° $f_{\text{PWM}}$ ã¯ CPU ã‚¯ãƒ­ãƒƒã‚¯ $f_{\text{sys}}$ ã«å¯¾ã—ã¦ä»¥ä¸‹ã®å¼ã§è¨ˆç®—ã•ã‚Œã¾ã™ã€‚

$$f_{\text{PWM}} = \frac{f_{\text{sys}}}{\text{clkdiv} \cdot (\text{wrap} + 1)}$$

### æœ€é«˜å‘¨æ³¢æ•°ã¨æœ€ä½å‘¨æ³¢æ•°

`clkdiv` å€¤ã‚’ 1.0ã€`wrap` å€¤ã‚’ 1 ã«è¨­å®šã™ã‚‹ã¨ã€PWM ã®æœ€é«˜å‘¨æ³¢æ•°ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚Pico 2 ã®å ´åˆã€ã“ã‚Œã¯ $\frac{150\text{MHz}}{1 \cdot (1 + 1)}$ = 75MHz ã«ãªã‚Šã¾ã™ã€‚ãŸã ã—ã€ãƒ‡ãƒ¥ãƒ¼ãƒ†ã‚£æ¯”ã¯ 0% (`level` = 0), 50% (`level` = 1), 100% (`level` = 2) ã® 3 ç¨®é¡ã—ã‹è¨­å®šã§ãã¾ã›ã‚“ã€‚

`clkdiv` å€¤ã‚’ 255.9ã€`wrap` å€¤ã‚’ 65535 ã«è¨­å®šã™ã‚‹ã¨ã€PWM ã®æœ€ä½å‘¨æ³¢æ•°ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚Pico 2 ã®å ´åˆã€ã“ã‚Œã¯ $\frac{150\text{MHz}}{255.9 \cdot (65535 + 1)}$ = ç´„ 8.9Hz ã«ãªã‚Šã¾ã™ã€‚

### PWM ãƒ‡ãƒ¥ãƒ¼ãƒ†ã‚£æ¯”ã®è¨­å®šæ–¹æ³•

PWM ã®ãƒ‡ãƒ¥ãƒ¼ãƒ†ã‚£æ¯”ã¯ã€`level` å€¤ã‚’è¨­å®šã™ã‚‹ã“ã¨ã§åˆ¶å¾¡ã—ã¾ã™ã€‚

PWM ã‚¹ãƒ©ã‚¤ã‚¹ã¯ã€ã‚«ã‚¦ãƒ³ã‚¿ãŒ 0 ã«ãªã£ãŸã¨ãã«å‡ºåŠ›ã‚’ high ã«ã—ã¾ã™ã€‚ãã“ã‹ã‚‰ã‚«ã‚¦ãƒ³ã‚¿å€¤ã‚’å¢—ã‚„ã—ã¦ã„ãã€`level` å€¤ã«ãªã£ãŸã¨ãã«å‡ºåŠ›ã‚’ low ã«ã—ã¾ã™ã€‚ã•ã‚‰ã«ã‚«ã‚¦ãƒ³ã‚¿å€¤ã‚’å¢—ã‚„ã—ã¦ `wrap` å€¤ã«ãªã‚‹ã¨ 0 ã«æˆ»ã‚Šã¾ã™ã€‚

`level` ãŒã¨ã‚‹å€¤ã¯ 0 ã‹ã‚‰ `wrap` + 1 ã¾ã§ã®ç¯„å›²ã§ã™ã€‚`level` ãŒ `wrap` + 1 ã®å ´åˆã¯ã€ã‚«ã‚¦ãƒ³ã‚¿ãŒãã®å€¤ã«é”ã™ã‚‹ã“ã¨ã¯ãªã„ã®ã§ã€å‡ºåŠ›ã¯å¸¸ã« high ã«ãªã‚Šã¾ã™ (ãƒ‡ãƒ¥ãƒ¼ãƒ†ã‚£æ¯” 100%)ã€‚

ã“ã“ã§ä¸€ã¤ç–‘å•ãŒç”Ÿã¾ã‚Œã¾ã™ã€‚`level` ã‚’ 0 ã«è¨­å®šã™ã‚‹ã¨ã©ã†ãªã‚‹ã®ã§ã—ã‚‡ã†ã‹? ã‚«ã‚¦ãƒ³ã‚¿ãŒ 0 ã«ãªã£ãŸã¨ãã€PWM ã‚¹ãƒ©ã‚¤ã‚¹ã¯å‡ºåŠ›ã‚’ high ã«ã—ã¾ã™ãŒã€ãã‚Œã¯åŒæ™‚ã« `level` ã«é”ã—ãŸã“ã¨ã§ã‚‚ã‚ã‚‹ã®ã§ low ã«ã‚‚ã—ãªã‘ã‚Œã°ã„ã‘ã¾ã›ã‚“ã€‚

å‡ºåŠ›ãŒ high ã«ãªã£ã¦ãã®ç›´å¾Œã« low ã«ãªã‚‹ã€ã‚¤ãƒ³ãƒ‘ãƒ«ã‚¹ã®ã‚ˆã†ãªæ³¢å½¢ãŒå‡ºåŠ›ã•ã‚Œã‚‹? å®Ÿéš›ã€ãã®ã‚ˆã†ãªå‡ºåŠ›ã‚’ã—ã¦ã—ã¾ã†ãƒãƒƒãƒ—ã‚‚ã‚ã‚Šã€ã“ã®ç¾è±¡ã‚’ã‚°ãƒªãƒƒãƒã¨å‘¼ã³ã¾ã™ã€‚ã§ã‚‚ã“ã®ã‚ˆã†ãªä¿¡å·ã¯åˆ¶å¾¡å¯¾è±¡ã®ãƒ‡ãƒã‚¤ã‚¹ã®èª¤å‹•ä½œã‚’å¼•ãèµ·ã“ã™å¯èƒ½æ€§ãŒã‚ã£ã¦å¥½ã¾ã—ãã‚ã‚Šã¾ã›ã‚“ã€‚

Pico ã§ã¯ã“ã®ã‚ãŸã‚Šã‚’ãã¡ã‚“ã¨è€ƒæ…®ã—ã¦ã„ã¦ã€`level` ã‚’ 0 ã«è¨­å®šã™ã‚‹ã¨ã€å‡ºåŠ›ãŒå¸¸ã« low ã«ãªã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ (ãƒ‡ãƒ¥ãƒ¼ãƒ†ã‚£æ¯” 0%)ã€‚ã‚°ãƒªãƒƒãƒãŒç”Ÿã˜ã‚‹å¿ƒé…ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

`level` å€¤ã«å¯¾ã™ã‚‹ãƒ‡ãƒ¥ãƒ¼ãƒ†ã‚£æ¯”ã¯ä»¥ä¸‹ã®å¼ã§è¨ˆç®—ã•ã‚Œã¾ã™ã€‚

$$\text{duty} = \frac{\text{level}}{\text{wrap} + 1}$$

`level` ãŒã¨ã‚‹å€¤ã¯ 0 ã‹ã‚‰ `wrap` + 1 ã¾ã§ã§ã™ã‹ã‚‰ã€`wrap` å€¤ãŒå¤§ãã„ã»ã© `level` ã§è¨­å®šã§ãã‚‹ãƒ‡ãƒ¥ãƒ¼ãƒ†ã‚£æ¯”ã®åˆ†è§£èƒ½ãŒé«˜ããªã‚Šã¾ã™ã€‚

### Phase Correct PWM

é€šå¸¸ã® PWM ã¯ã‚«ã‚¦ãƒ³ã‚¿ãŒã€€0 ã‹ã‚‰ `wrap` å€¤ã«é”ã™ã‚‹ã¾ã§ã‚«ã‚¦ãƒ³ãƒˆã‚¢ãƒƒãƒ—ã—ã¦ã„ãã¾ã™ãŒã€Phase Correct PWM ã§ã¯ã‚«ã‚¦ãƒ³ã‚¿ãŒ 0 ã‹ã‚‰ `wrap` å€¤ã«é”ã—ãŸå¾Œã€å†ã³ 0 ã«æˆ»ã‚‹ã®ã§ã¯ãªãã€`wrap` å€¤ã‹ã‚‰ 0 ã«å‘ã‹ã£ã¦ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€PWM ä¿¡å·ã®ä¸Šæ˜‡ã¨ä¸‹é™ãŒå¯¾ç§°ã«ãªã‚Šã€ãƒ‡ãƒ¥ãƒ¼ãƒ†ã‚£æ¯”ã‚’å¤‰åŒ–ã—ãŸã¨ãã§ã‚‚ä½ç›¸ãŒãã‚ã£ãŸæ³¢å½¢ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚

`pwm` ã‚³ãƒãƒ³ãƒ‰ã§ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰ `phase-correct:true` ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€Phase Correct PWM ãŒæœ‰åŠ¹ã«ãªã‚Šã¾ã™ã€‚

ä»¥ä¸‹ã®æ‰‹é †ã§ã€æ³¢å½¢ã‚’è¦³æ¸¬ã—ãªãŒã‚‰ Phase Correct PWM ã®å‹•ä½œã‚’ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

1. ãƒ­ã‚¸ãƒƒã‚¯ã‚¢ãƒŠãƒ©ã‚¤ã‚¶ã‚’èµ·å‹•ã—ã¦ã€€GPIO2, GPIO3, GPIO4, GPIO5 ã® 4 æœ¬ã®ãƒ”ãƒ³ã®æ¸¬å®šã‚’é–‹å§‹ã—ã¾ã™ã€‚

   ```text
   L:/>la -p 2-5 enable
   ```

2. å‘¨æ³¢æ•°ãŒ 100Hzã€ãƒ‡ãƒ¥ãƒ¼ãƒ†ã‚£æ¯”ãŒãã‚Œãã‚Œ 0.2, 0.4, 0.6, 0.8 ã® PWM ä¿¡å·ã‚’å‡ºåŠ›ã—ã¾ã™ã€‚Phase Correct PWM ã‚’æœ‰åŠ¹ã«ã™ã‚‹ãŸã‚ã«ã€ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰ `phase-correct:true` ã‚’æŒ‡å®šã—ã¾ã™ã€‚Phase Correct ã®è¨­å®šã¯å‘¨æ³¢æ•°ã«å½±éŸ¿ã™ã‚‹ã®ã§ã€`freq` ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰ã‚ˆã‚Šã‚‚å‰ã«æŒ‡å®šã—ã¾ã™ã€‚

   ```text
   L:/>pwm 2-5 func:pwm disable phase-correct:true freq:100 counter:0
   L:/>pwm2 duty:.2; pwm3 duty:.4; pwm4 duty:.6; pwm5 duty:.8
   L:/>pwm 2-5 enable
   ```

3. æ¸¬å®šã—ãŸæ³¢å½¢ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

   ```text
   L:/>la print
   ```

æ¸¬å®šçµæœã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ã€‚ä½ç›¸ã®åŸºæº–ç‚¹ã«å¯¾ã—ã¦å·¦å³å¯¾ç§°ã§ãƒ‘ãƒ«ã‚¹å¹…ãŒå¤‰åŒ–ã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚

![pwm-test-2.png](/images/2025-08-06-labo-pwm/pwm-test-2.png)

Phase Correct PWM ã¯ã‚«ã‚¦ãƒ³ãƒˆã‚¢ãƒƒãƒ—ã¨ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ã‚’è¡Œã†ãŸã‚ã€PWM ä¿¡å·ã®å‘¨æ³¢æ•°ã¯é€šå¸¸ã® PWM ã® 1/2 ã«ãªã‚Šã¾ã™ã€‚Phase Correct ã‚’æœ‰åŠ¹ã«ã—ãŸ $f_{\text{PWM}}$ ã¯ CPU ã‚¯ãƒ­ãƒƒã‚¯ $f_{\text{sys}}$ ã«å¯¾ã—ã¦ä»¥ä¸‹ã®å¼ã§è¨ˆç®—ã•ã‚Œã¾ã™ã€‚

$$f_{\text{PWM}} = \frac{f_{\text{sys}}}{2 \cdot \text{clkdiv} \cdot (\text{wrap} + 1)}$$

## C/C++ API ã¨ã®é–¢é€£

`pwm` ã®ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰ã«ç›¸å½“ã™ã‚‹ Pico SDK ã® API ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚

| ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰     | Pico SDK API |
|-----------------|-------|
| `func`          | `gpio_set_function(uint gpio, gpio_function_t fn)`|
| `enable`        | `pwm_set_enabled(uint slice_num, bool enabled)`|
| `disable`       | `pwm_set_enabled(uint slice_num, bool enabled)`|
| `freq`          | (ãªã—ã€‚`clkdiv` ã¨ `wrap` ã‹ã‚‰è¨ˆç®—) |
| `clkdiv`        | `pwm_set_clkdiv(uint slice_num, float divider)` |
| `wrap`          | `pwm_set_wrap(uint slice_num, uint16_t wrap)` |
| `duty`          | (ãªã—ã€‚`level` ã¨ `wrap` ã‹ã‚‰è¨ˆç®—) |
| `level`         | `pwm_set_chan_level(uint slice_num, uint chan, uint16_t level)` |
| `counter`       | `pwm_set_counter(uint slice_num, uint16_t c)` |
| `phase-correct` | `pwm_set_phase_correct(uint slice_num, bool phase_correct)` |

`pwm` ã®ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰ã«ç›¸å½“ã™ã‚‹ [pico-jxglib](https://zenn.dev/ypsitau/articles/2025-01-24-jxglib-intro) ã® API ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚

| ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰     | pico-jxglib API |
|-----------------|-------|
| `func`          | `GPIO::set_function(gpio_function_t fn)`|
| `enable`        | `PWM::set_enabled(bool enabled)`|
| `disable`       | `PWM::set_enabled(bool enabled)`|
| `freq`          | `PWM::set_freq(uint32_t freq)` |
| `clkdiv`        | `PWM::set_clkdiv(float divider)` |
| `wrap`          | `PWM::set_wrap(uint16_t wrap)` |
| `duty`          | `PWM::set_chan_duty(float duty)` |
| `level`         | `PWM::set_chan_level(uint16_t level)` |
| `counter`       | `PWM::set_counter(uint16_t c)` |
| `phase-correct` | `PWM::set_phase_correct(bool phase_correct)` |

## ã¾ã¨ã‚

ã“ã®è¨˜äº‹ã§ã¯ã€pico-jxgLABO ã‚’ä½¿ã£ã¦ Pico ã® PWM æ©Ÿèƒ½ã‚’å®Ÿé¨“ã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã—ãŸã€‚PWM ã®è¨­å®šã‚„å‹•ä½œã‚’ç†è§£ã™ã‚‹ãŸã‚ã«ã€å®Ÿéš›ã«ã‚³ãƒãƒ³ãƒ‰ã‚’æ“ä½œã—ã€ãƒ­ã‚¸ãƒƒã‚¯ã‚¢ãƒŠãƒ©ã‚¤ã‚¶ã§æ³¢å½¢ã‚’è¦³æ¸¬ã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚

Pico ã® PWM æ©Ÿèƒ½ã¯ã€ãƒ¢ãƒ¼ã‚¿ãƒ¼ã®é€Ÿåº¦åˆ¶å¾¡ã‚„ LED ã®æ˜ã‚‹ã•èª¿æ•´ãªã©ã€æ§˜ã€…ãªç”¨é€”ã§æ´»ç”¨ã§ãã¾ã™ã€‚ä»Šå›ã®å®Ÿé¨“ã‚’é€šã˜ã¦ã€PWM ã®åŸºæœ¬çš„ãªæ¦‚å¿µã‚„è¨­å®šæ–¹æ³•ã‚’ç†è§£ã—ã€å®Ÿéš›ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«å¿œç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã¨æ€ã„ã¾ã™ã€‚ 
