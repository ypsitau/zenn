---
title: "Pico ボードで電光掲示板を作ろう! コマンド操作でフルカラーシリアル LED を制御する方法"
emoji: "🙌"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["raspberry", "raspberrypi", "pico", "led", "labo"]
published: false
published_at: 2025-11-11 09:00
---
[pico-jxgLABO](https://zenn.dev/ypsitau/articles/2025-08-01-labo-intro) は、USB ケーブル一本でマイコンボード RaspberryPi Pico の様々な機能を試すことができる実験プラットフォームです。

今回は、フルカラーシリアル LED WS2812 を使って電光掲示板を作ります。pico-jxgLABO を使うとコマンド操作だけで WS2812 を制御できるので、**プログラムを書く必要はありません**。簡単なコマンドを使って LED を点灯させたり、アニメーションを表示したりできます。

クリスマスが近いので、イルミネーションとしても使えますよ!

## フルカラーシリアル LED WS2812 について

フルカラーシリアル LED は、RGB 各色の LED と制御回路が一体化された LED です。1 個の LED チップで 24 ビット (8 ビット x 3 色) のカラー表現が可能で、非常に鮮やかな発色が特徴です。 また、シリアル通信で制御できるため、複数の LED を直列に接続しても、制御信号線は 1 本で済みます。これにより、多数の LED を使ったディスプレイやイルミネーションの構築が容易になります。

サードパーティが提供する Raspberry Pi Pico 互換のボードには WS2812 が搭載されているものがあります。例えば、Speed Studio XIAO RP2040 や Waveshare RP2040-Zero などです。

![speedstudio-xiao-rp2040-and-waveshare-rp2040-zero](/images/2025-11-11-labo-led/speedstudio-xiao-rp2040-and-waveshare-rp2040-zero.jpg)
*Speed Studio XIAO RP2040 (左) と Waveshare RP2040-Zero (右)*

WS2812 を一列に並べた LED ストリップも市販されています。

![ws2812-strip](/images/2025-11-11-labo-led/ws2812-strip.jpg)

また、マトリクス状に配置された WS2812 モジュールもあり、これを使うと小型のディスプレイを簡単に作成できます。以下は 16x16 のマトリクスモジュールです。

![ws2812-matrix](/images/2025-11-11-labo-led/ws2812-matrix.jpg)

形状は様々ですが、基本的な制御方法は同じです。VCC と GND に電源を接続し、DIN (Data In) ピンに制御信号を接続します。パルス幅変調によって 1 と 0 の信号を送信し、RGB 24 ビットのデータを連続して送ることで LED の色を設定します。

![ws2812-pinout](/images/2025-11-11-labo-led/ws2812-pinout.jpg)

DOUT (Data Out) ピンは、次の LED チップにデータを送信するための出力です。複数の WS2812 を直列に接続する場合、最初の LED の DOUT を次の LED の DIN に接続します。

## pico-jxgLABO の書き込み

Pico ボードへの pico-jxgLABO の書き込みと基本的な使い方は[こちら](https://zenn.dev/ypsitau/articles/2025-08-01-labo-intro#pico-jxglabo-%E3%81%AE%E5%B0%8E%E5%85%A5%E6%96%B9%E6%B3%95)。特別なハードウェアは必要なく、Pico W や Pico 2 W ボードを USB ケーブルで PC に接続するだけで始められます。

この記事で説明する実験を行うには、バージョン **0.5.0** 以降の pico-jxgLABO が Pico ボードに書き込まれている必要があります。ターミナルソフトで `about-me` コマンドを実行すると pico-jxgLABO のバージョンを確認できます。

```text
L:/>about-me
Program Information
 name:              pico-jxgLABO
 version:           0.5.0
     :
     :
```

## コマンドの使い方

pico-jxgLABO では、WS2812 を直接制御するための `ws2812` コマンドと、ディスプレイとして扱えるようにする `display-ws2812` コマンドが用意されています。以下に、基本的なコマンドを紹介します。

### フルカラーシリアル LED を直接制御する

`ws2812` コマンドで WS2812 を単独で制御することができます。

まず、`setup` サブコマンドで WS2812 の接続情報を設定します。`din` パラメータでデータ入力ピンを指定します。

```text
L:/>ws2812 setup {din:PIN}
```

以下に、ハードウェアごとの制御例を示します。

- Speed Studio XIAO RP2040 ボードの場合、DIN ピンは GPIO12 に接続されています。また、VCC が GPIO11 に接続されているので、このピンのファンクションをデジタル出力に設定して 1 を出力します。

  ```text
  L:/>ws2812 setup {din:12}
  L:/>gpio11 func:sio dir:out put:1
  ```

- Waveshare RP2040-Zero ボードの場合、DIN ピンは GPIO 16 に接続されているので、以下のように設定します。

  ```text
  L:/>ws2812 setup {din:16}
  ```

- LED ストリップやマトリクスモジュールを使う場合も設定方法は同じです。例えば、GPIO15 にこれらのデバイスを接続する場合は以下のようにします。

  ```text
  L:/>ws2812 setup {din:15}
  ```

以下、LED ストリップを使って操作方法を説明します。

`put` サブコマンドで LED の色を指定します。例えば、赤色に点灯させるには以下のようにします。

```text
L:/>ws2812 put:red
```

![ws2812-red](/images/2025-11-11-labo-led/ws2812-red.jpg)

16 進カラーコードで指定することもできます。

```text
L:/>ws2812 put:#ff0000
```

`put` サブコマンドを複数回使うと、直列に接続された複数の LED の色を設定できます。

```text
L:/>ws2812 put:red put:green put:blue
```

![ws2812-rgb](/images/2025-11-11-labo-led/ws2812-rgb.jpg)

マイコンに近い方の LED から順に色が設定されます。

### フルカラーシリアル LED をディスプレイとして扱う

#### `display-ws2812` コマンドの使い方

`display-ws2812` コマンドを使うと、WS2812 をディスプレイとして扱うことができます。LED ストリップに流れるような点灯パターンを表示したり、二次元マトリクス状に配置された WS2812 モジュールに画像やアニメーションを表示したりできます。

`display-ws2812` の `setup` サブコマンドで WS2812 の接続情報とディスプレイの形状を設定します。

```text
L:/>display-ws2812 setup {din:15 straight:60}
```

`din` サブコマンドでデータ入力ピン DIN に接続した GPIO ピンを指定します。`straight:n` は、n 個の LED が直線状に 60 個並んでいることを示します。

```text
L:/>ls-display
```

60 x 1 ピクセルのディスプレイとして認識されていることが分かります。

二次元マトリクス状に配置された WS2812 モジュールを使う場合は、`straight` の代わりに `LAYOUT-START-DIR:WIDTH,HEIGHT` の形式で、各フィールドを以下のように指定します。

- `LAYOUT` には `zigzag` または `straight` を指定します
- `START` にはマイコンから見て一番最初の LED の位置を `nw` (左上), `ne` (右上), `sw` (左下), `se` (右下) のいずれかで指定します
- `DIR` には `horz` (水平方向) または `vert` (垂直方向) のいずれかを指定します。
- `WIDTH` と `HEIGHT` にはそれぞれマトリクスの幅と高さを指定します。

例えば、16x16 のマトリクスモジュールを左上から始まり、縦方向にジグザグに配線されている場合は `zigzag-nw-vert:16,16` のように指定します。

```text
L:/>display-ws2812 setup {din:15 zigzag-nw-vert:16,16}
```

#### 画像やアニメーションの表示

ディスプレイに画像を表示するには `draw` コマンドを使います。

まず、表示したい画像ファイルを Pico ボードの内部ストレージ `L:` ドライブに保存します。対応する画像フォーマットは JPEG, PNG, BMP です。USB ケーブルでホスト PC に接続すると、Pico ボードの `L:` ドライブは USB メモリとしてホスト PC に認識されるので、そのドライブに画像ファイルをコピーします。

`image-load` サブコマンドで画像ファイルを読み込みます。

```text
L:/>draw image-load:alphabet-white.png
```

`image` サブコマンドで画像を表示します。このとき、`offset` と `size` サブコマンドでイメージ内の表示領域を指定します。

```text
L:/>draw image {offset:0,0 size:16,16}
```

`offset-shift` サブコマンドを使うと、イメージ内の表示領域の位置を指定量だけずらすことができます。以下は、表示領域を右に 1 ピクセルずらす例です。

```text
L:/>draw image {offset-shift:1,0}
```

何度か実行して、表示内容がずれていくことを確認してみてください。

`repeat` サブコマンドは、ブレース `{}` 内のコマンドを繰り返し実行します。`Ctrl-C` キーを押すと繰り返しを停止できます。

```text
L:/>draw repeat { image {offset-shift:1,0} }
```

表示速度が速すぎてよく見えないですね。`sleep` サブコマンドで指定したミリ秒だけ処理を一時停止できるので、これを使って表示速度を調整しましょう。以下は 100 ミリ秒で表示位置をずらす例です。

```text
L:/>draw repeat { image {offset-shift:1,0} sleep:100 }
```

## まとめ

pico-jxgLABO を使うと、Raspberry Pi Pico ボードでフルカラーシリアル LED WS2812 を簡単に制御できます。コマンド操作だけで LED の点灯やアニメーション表示が可能なので、プログラムを書く手間を省けます。 WS2812 を使った電光掲示板やイルミネーションの作成にぜひ挑戦してみてください!
